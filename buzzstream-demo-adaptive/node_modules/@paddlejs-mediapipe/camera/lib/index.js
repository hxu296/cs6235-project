!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.paddlejsCamera=e():t.paddlejsCamera=e()}(self,(function(){return(()=>{"use strict";var t={607:(t,e,i)=>{i.r(e),i.d(e,{default:()=>o});const o=function(){function t(t,e){void 0===e&&(e={}),this.noop=function(){},this.defaultOption={mirror:!1,targetCanvas:null,onSuccess:this.noop,onError:this.noop,onNotSupported:this.noop,onFrame:this.noop,switchError:this.noop,videoLoaded:this.noop},this.video=t,this.options=Object.assign({},this.defaultOption,e),this.currentMode="user",this.initVideoStream()}return t.prototype.initVideoStream=function(){var t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),this.video.width=this.options.width||this.video.clientWidth,this.video.height=this.options.height||this.video.clientHeight,this.enumerateDevices()},t.prototype.handleStream=function(){var t=this,e={deviceId:{exact:this.videoDeviceId},facingMode:this.currentMode,width:this.video.width,height:this.video.height};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:e}).then((function(e){t.stream=e,t.streamCallback()})).catch(this.options.onError):(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?navigator.getUserMedia({video:e},(function(e){t.stream=e,t.streamCallback()}),this.options.onError):this.options.onNotSupported())},t.prototype.enumerateDevices=function(){var t=this;navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((function(e){var i=[];e.forEach((function(t){"videoinput"===t.kind&&i.push(t.deviceId)})),t.videoDevices=i,t.videoDevices.length<2&&!t.isIOS&&t.options.switchError&&t.options.switchError(),t.videoDeviceId=t.videoDevices[0],t.handleStream()})).catch((function(e){t.options.onNotSupported&&t.options.onNotSupported(),console.error(e.name+": "+e.message)})):this.options.onNotSupported&&this.options.onNotSupported()},t.prototype.streamCallback=function(){var t=this;this.options.onSuccess();var e=window.URL||window.webkitURL||window.mozURL||window.msURL;if("srcObject"in this.video)try{this.video.srcObject=this.stream}catch(t){this.video.src=e.createObjectURL(this.stream)||this.stream}this.video.addEventListener("loadeddata",(function(){t.options.height?t.video.width=t.video.clientWidth:t.video.height=t.video.clientHeight,t.options.videoLoaded&&t.options.videoLoaded(),t.initCanvas()}))},t.prototype.stopMediaTracks=function(){var t,e;null===(e=null===(t=this.stream)||void 0===t?void 0:t.getTracks())||void 0===e||e.forEach((function(t){t.stop()}))},t.prototype.initCanvas=function(){this.options.targetCanvas&&(this.canvas=this.options.targetCanvas,this.canvas.width=this.video.width,this.canvas.height=this.video.height,this.context=this.canvas.getContext("2d"),this.options.mirror&&(this.context.translate(this.canvas.width,0),this.context.scale(-1,1)))},t.prototype.videoRequestAnimationFrame=function(){var t=this,e=function(){t.context&&t.context.drawImage(t.video,0,0,t.video.width,t.video.height),t.options.onFrame(t.video),t.requestAnimationId=requestAnimationFrame(e)};e()},t.prototype.start=function(){this.video&&this.video.play(),this.requestAnimationId||this.videoRequestAnimationFrame()},t.prototype.pause=function(){this.video&&this.video.pause(),this.canvas&&this.requestAnimationId&&(cancelAnimationFrame(this.requestAnimationId),this.requestAnimationId=null)},t.prototype.switchCameras=function(){if(this.isIOS||this.videoDevices&&!(this.videoDevices.length<2)){this.stopMediaTracks();var t=this.currentMode;this.currentMode="user"===t?"environment":"user";var e=this.videoDeviceId;this.videoDeviceId=e===this.videoDevices[0]?this.videoDevices[1]:this.videoDevices[0],this.handleStream()}},t}()}},e={};function i(o){if(e[o])return e[o].exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}return i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(607)})()}));